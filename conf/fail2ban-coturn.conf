# Fail2Ban jail for coturn TURN server
# Protects against brute-force authentication attempts and relay abuse
#
# This file should be placed in: /etc/fail2ban/jail.d/coturn.conf
#
# Detection:
# - Authentication failures (wrong credentials, unauthorized access)
# - Allocation failures (failed TURN relay allocation attempts)
# - Abuse attempts (repeated unauthorized connection attempts)
#
# Settings:
# - Max retries: 5 attempts in 10 minutes
# - Ban time: 1 hour
# - Action: Block all ports from attacker IP

[coturn]
enabled = true
port = 3478,5349
protocol = all
filter = coturn
logpath = /var/log/turnserver.log
maxretry = 5
findtime = 600
bantime = 3600
action = iptables-allports[name=coturn]

