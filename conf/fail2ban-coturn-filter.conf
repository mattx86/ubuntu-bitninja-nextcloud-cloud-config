# Fail2Ban filter for coturn TURN server
# Detects authentication failures and abuse attempts
#
# This file should be placed in: /etc/fail2ban/filter.d/coturn.conf
#
# Detection patterns:
# - Authentication errors (wrong credentials, realm errors)
# - Allocation failures (failed TURN relay allocation attempts)
# - Unauthorized access attempts
# - Wrong credentials
#
# Log file monitored: /var/log/turnserver.log

[Definition]

# Authentication failures
failregex = ^.*session.*user <HOST>.*realm.*ERROR.*$
            ^.*session.*user <HOST>.*allocation.*failed.*$
            ^.*session.*user <HOST>.*unauthorized.*$
            ^.*session.*<HOST>.*authentication failed.*$
            ^.*session.*<HOST>.*wrong credentials.*$
            ^.*<HOST>.*Unauthorized.*$

ignoreregex =

